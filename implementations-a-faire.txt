# IMPLEMENTATIONS Ã€ FAIRE - COURSESCOPE FRONTEND

## ğŸ“Š MÃ‰TRIQUES MANQUANTES (ANALYSE COMPÃ‰TITION)

### **ğŸ” MÃ‰TRIQUES IDENTIFIÃ‰ES CHEZ GARMIN/STRAVA/COROS**

#### **MÃ©triques Puissance (Premium)**
```
âœ… Power Zones (basÃ© sur FTP/Threshold)
âœ… Normalized Power (NP)  
âœ… Intensity Factor (IF)
âœ… Training Stress Score (TSS)
âœ… Power Profile (Watts/kg)
âš ï¸ Peak Power/Watts
âš ï¸ Power Duration Curve
```

#### **ğŸƒï¸ MÃ©triques AvancÃ©es Course**
```
âœ… GAP (Grade Adjusted Pace)
âœ… Grade Analysis (pente moyenne/max)
âš ï¸ Running Dynamics (stride, vertical oscillation, ground contact)
âœ… VAM (Velocity Ascent Meter/h)
âš ï¸ Cardiac Drift (HRR analysis)
âœ… Pacing Stability (consistency)
âœ… Training Load (TRIMP)
```

#### **ğŸ“ˆ MÃ©triques Recovery & Fatigue**
```
âš ï¸ Recovery Time (post-activity)
âš ï¸ Sleep Quality Integration
âš ï¸ Training Readiness Score
âš ï¸ Heart Rate Variability (HRV)
âš ï¸ Fatigue Index
âš ï¸ Daily Stress Score
```

#### **ğŸ“Š Analyses de Performance**
```
âœ… Performance Predictions (temps sur distance cible)
âœ… Race Time Prediction
âœ… Segment Analysis (best times on sections)
âš ï¸ Weather Impact Analysis
âš ï¸ Equipment Impact (chaussures, terrain)
âš ï¸ Training Volume Analysis (weekly/monthly trends)
âœ… Personal Records tracking
```

#### **ğŸ¯ Social & Gamification**
```
âš ï¸ Achievement System
âš ï¸ Virtual Challenges
âš ï¸ Training Streaks
âš ï¸ Badges/Milestones
âš ï¸ Community Leaderboards
âš ï¸ Social Sharing enhanced
```

---

## ğŸ“ˆ GRAPHIQUES Ã€ IMPLÃ‰MENTER (Next.js)

### **ğŸ”¥ GRAPHIQUES DYNAMIQUES PRIORITAIRES**

#### **1. Graphique Allure vs DÃ©nivelÃ© (Core - Exist)**
```typescript
// Composant: PaceGradeChart.tsx
interface Props {
  data: Array<{distance: number, elevation: number, pace: number}>;
  showGradeAnalysis?: boolean;
  paceThreshold?: number;
}

FonctionnalitÃ©s:
- Courbe allure (min/km) avec axe distance
- Courbe dÃ©nivelÃ© avec axe distance secondaire
- Points colorÃ©s par pente (>10% = rouge, 0-10% = jaune, <0% = vert)
- Seuil d'allure paramÃ©trable
- Analyse de la pente moyenne/max
```

#### **2. Graphique Cardiaque (Premium)**
```typescript
// Composant: HeartRateChart.tsx
interface Props {
  data: Array<{time: number, heartRate: number}>;
  zones?: Array<{min: number, max: number, color: string, name: string}>;
  showHRR?: boolean;
}

FonctionnalitÃ©s:
- Courbe FC tout au long de l'activitÃ©
- Zones FC colorÃ©es et personnalisables
- Heart Rate Reserve (HRR) calculation
- FC moyenne/max/min
- Recovery analysis (temps retour Ã  la normale)
```

#### **3. Graphique Puissance (Premium)**
```typescript
// Composant: PowerChart.tsx
interface Props {
  data: Array<{time: number, power: number, cadence?: number}>;
  ftp?: number;
  showNP?: boolean;
  showTSS?: boolean;
}

FonctionnalitÃ©s:
- Courbe puissance (Watts) vs temps
- Normalized Power (NP) visualization
- Power Zones avec FTP
- TSS accumulation
- Cadence overlay optionnel
```

#### **4. Graphique GAP Analysis (AmÃ©liorÃ©)**
```typescript
// Composant: GAPAnalysisChart.tsx
interface Props {
  data: Array<{distance: number, elevation: number, actualPace: number, gradeAdjustedPace: number}>;
}

FonctionnalitÃ©s:
- Scatter plot: Allure rÃ©elle vs Allure ajustÃ©e
- Zones d'efficacitÃ© (positive/negative GAP)
- Distribution des segments (+/-)
- Identification des sections d'amÃ©lioration/rÃ©gression
```

#### **5. Graphique Training Load (Advanced)**
```typescript
// Composant: TrainingLoadChart.tsx
interface Props {
  dailyData: Array<{date: string, load: number, activityType: string}>;
  weeklyData: Array<{week: number, avgLoad: number}>;
}

FonctionnalitÃ©s:
- Bar chart : Charge d'entraÃ®nement quotidienne
- Tendance 7 jours (rolling average)
- Zones de charge (optimale/overtraining/danger)
- Activity type breakdown
```

#### **6. Graphique Performance Predictions**
```typescript
// Composant: PerformanceChart.tsx
interface Props {
  historicalData: Array<{date: string, distance: number, time: number}>;
  targetDistance: number;
  predictions?: Array<{method: string, predictedTime: number}>;
}

FonctionnalitÃ©s:
- Courbe de performance historique
- PrÃ©dictions de temps (mÃ©thodes multiples)
- Target pacing visualization
- Confidence intervals
```

---

## ğŸš€ GRAPHIQUES SECONDAIRES

#### **7. Distribution d'Allure**
```typescript
// Composant: PaceDistributionChart.tsx
interface Props {
  paceData: Array<{pace: number, duration: number}>;
  showPercentiles?: boolean;
}

FonctionnalitÃ©s:
- Histogramme des vitesses
- Percentiles (25%, 50%, 75%, 90%)
- Mode/Zones d'allure
- DurÃ©e cumulÃ©e par zone
```

#### **8. Cadence & Running Dynamics**
```typescript
// Composant: CadenceChart.tsx
interface Props {
  cadenceData: Array<{time: number, cadence: number, strideLength?: number}>;
  dynamicsData?: Array<{time: number, groundContactTime?: number, verticalOscillation?: number}>;
}

FonctionnalitÃ©s:
- Courbe cadence (spm) vs temps
- Running dynamics overlay
- Stride length analysis
- Ground contact time visualization
```

#### **9. Zones d'EntraÃ®nement CombinÃ©es**
```typescript
// Composant: CombinedZonesChart.tsx
interface Props {
  paceZones?: Array<{min: number, max: number, color: string}>;
  powerZones?: Array<{min: number, max: number, color: string}>;
  heartRateZones?: Array<{min: number, max: number, color: string}>;
}

FonctionnalitÃ©s:
- Zones multi-critÃ¨res (allure/puissance/FC)
- Heatmap temps passÃ© dans chaque zone
- Transitions entre zones
- Compteurs temps par zone
```

#### **10. Graphiques de Comparaison**
```typescript
// Composant: ComparisonChart.tsx
interface Props {
  activities: Array<{id: string, name: string, date: string, metrics: ActivityMetrics}>;
  comparisonMetrics: Array<string>;
  showRelativeDifferences?: boolean;
}

FonctionnalitÃ©s:
- Comparaison multi-activitÃ©s
- Radar chart pour mÃ©triques clÃ©s
- Tableau comparatif dÃ©taillÃ©
- Trend lines sur pÃ©riodes
```

---

## ğŸ”§ IMPLEMENTATIONS TECHNIQUES

### **ğŸ“Š LIBRAIRIES GRAPHIQUES**
```json
// package.json additions
{
  "recharts": "^3.7.0",           // Graphiques de base
  "d3": "^7.8.0",               // Visualisations avancÃ©es
  "chart.js": "^4.4.0",           // Alternative
  "react-chartjs-2": "^5.2.0"   // Canvas optimisÃ©
}
```

### **ğŸ¨ DATA PROCESSING**
```typescript
// services/chartDataService.ts
export class ChartDataService {
  static calculatePowerZones(ftp: number) { ... }
  static calculateHeartRateZones(maxHR: number, age: number) { ... }
  static calculatePaceDistribution(data: PaceData[]) { ... }
  static performGAPAnalysis(data: ActivityData[]) { ... }
}
```

### **ğŸ¯ PERFORMANCE OPTIMIZATIONS**
```typescript
// Optimisations recommandÃ©es
- useMemo() pour calculs coÃ»teux
- Virtual scrolling pour grands datasets
- Canvas-based charts pour >1000 points
- Lazy loading des composants graphiques
- Data aggregation pour visualisations temps rÃ©el
```

---

## ğŸ“‹ ROADMAP D'IMPLÃ‰MENTATION

### **PHASE 1 (1-2 semaines)**
1. âœ… PaceGradeChart (amÃ©liorÃ© avec analyse pente)
2. âœ… HeartRateChart (zones + HRR)
3. âœ… PowerChart (si FIT data disponible)
4. âœ… GAPAnalysisChart (scatter plot amÃ©liorÃ©)

### **PHASE 2 (2-3 semaines)**
5. âœ… TrainingLoadChart (intÃ©gration backend/api)
6. âœ… PerformanceChart (prÃ©dictions)
7. âœ… PaceDistributionChart (histogramme)
8. âœ… CadenceChart (si running dynamics)

### **PHASE 3 (3-4 semaines)**
9. âœ… CombinedZonesChart (multi-zones)
10. âœ… ComparisonChart (multi-activitÃ©s)
11. âœ… Carte thermique (performance sur parcours)
12. âœ… Tableaux de mÃ©triques avancÃ©es

---

## ğŸ¯ CRITÃˆRES DE SUCCÃˆS

### **Fonctionnel**
- âœ… Chaque graphique fonctionnel avec donnÃ©es rÃ©elles
- âœ… Responsive design (mobile/desktop)
- âœ… Performance acceptable (<1000ms rendering)
- âœ… AccessibilitÃ© (ARIA labels, keyboard navigation)
- âœ… Export des graphiques (PNG/SVG)

### ** Technique**
- âœ… TypeScript strict (pas de erreurs)
- âœ… Tests unitaires (>90% coverage)
- âœ… Components rÃ©utilisables
- âœ… Documentation Storybook

### ** UX/UI**
- âœ… Design cohÃ©rent avec reste de l'application
- âœ… Loading states et skeleton screens
- âœ… Empty states avec messages clairs
- âœ… Tooltips interactifs informatifs

---

## ğŸš¨ NOTES TECHNIQUES

### **IntÃ©gration API**
```typescript
// Exemple d'appel API pour graphiques
const fetchChartData = async (activityId: string) => {
  const response = await fetch(`/api/activity/${activityId}/chart-data`);
  return response.json();
};
```

### **Gestion des Ã©tats**
```typescript
// Pattern pour graphiques avec Ã©tats
const [chartData, setChartData] = useState<ChartData | null>(null);
const [isLoading, setIsLoading] = useState(false);
const [error, setError] = useState<string | null>(null);
```

### **Personnalisation**
```typescript
// Configuration utilisateur pour graphiques
interface UserPreferences {
  preferredZones: 'garmin' | 'custom' | '5zone';
  chartColors: string[];
  defaultMetrics: string[];
  animationSpeed: 'slow' | 'normal' | 'fast';
}
```

---

## ğŸ† PRIORITY DÃ‰VELOPPEMENT

### **HIGH PRIORITY** (Ã€ implÃ©menter en premier)
1. **PaceGradeChart amÃ©liorÃ©** - Fondamental, dÃ©jÃ  existant
2. **HeartRateChart** - TrÃ¨s demandÃ©, donnÃ©es disponibles
3. **PowerChart** - DiffÃ©renciant majeur, donnÃ©es FIT

### **MEDIUM PRIORITY** (Si temps disponible)
4. **GAPAnalysisChart** - Valeur analytique forte
5. **TrainingLoadChart** - IntÃ©gration continue required

### **LOW PRIORITY** (Bon Ã  avoir)
6. **PerformanceChart** - PrÃ©dictions avancÃ©es
7. **ComparisonChart** - FonctionnalitÃ© sociale
8. **CombinedZonesChart** - Complexe mais puissant

---

## ğŸ“Š MÃ‰TRIQUES Ã€ AJOUTER AU BACKEND

Pour supporter ces graphiques, le backend doit exposer :

### **Nouveaux Endpoints API**
```python
# backend/api/routes/charts.py
@router.get("/activity/{id}/charts/pace-grade")
async def get_pace_grade_chart(activity_id: str):
    # DonnÃ©es pour graphique allure vs dÃ©nivelÃ©
    
@router.get("/activity/{id}/charts/heart-rate")
async def get_heart_rate_chart(activity_id: str):
    # DonnÃ©es FC + zones
    
@router.get("/activity/{id}/charts/power")
async def get_power_chart(activity_id: str):
    # DonnÃ©es puissance + NP + TSS
```

### **Extensions Services**
```python
# backend/services/chart_service.py
class ChartService:
    @staticmethod
    def prepare_pace_grade_data(df: pd.DataFrame) -> dict:
        # PrÃ©paration donnÃ©es pour graphique
        
    @staticmethod  
    def calculate_zones(ftp: number, max_hr: number) -> dict:
        # Calcul zones optimisÃ©es
```

---

## ğŸ“ˆ DÃ‰TAILS D'IMPLÃ‰MENTATION

### **Configuration Required**
```env
# .env.local
NEXT_PUBLIC_ENABLE_CHARTS=true
NEXT_PUBLIC_CHART_ANIMATION_SPEED=normal
```

### **File Structure**
```
frontend/src/components/charts/
â”œâ”€â”€ PaceGradeChart.tsx          # âœ… EXISTE (amÃ©liorer)
â”œâ”€â”€ HeartRateChart.tsx          # ğŸ”¥ HIGH PRIORITY
â”œâ”€â”€ PowerChart.tsx              # ğŸ”¥ HIGH PRIORITY  
â”œâ”€â”€ GAPAnalysisChart.tsx         # ğŸŸ¡ MEDIUM PRIORITY
â”œâ”€â”€ TrainingLoadChart.tsx        # ğŸŸ¡ MEDIUM PRIORITY
â””â”€â”€ index.ts                     # Exports
```

---

**Ce document sert de feuille de route pour l'implÃ©mentation des graphiques avancÃ©s dans CourseScope Next.js. L'objectif est d'atteindre la paritÃ© fonctionnelle avec les meilleures applications de running analysis (Garmin Connect/Strava Premium).**